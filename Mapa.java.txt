import java.util.Random;

public class Mapa {
    private String tipoTerritorio;
    private Ejercito[][] tablero;
    private static final String[] TERRITORIOS = {"bosque", "campo abierto", "monta침a", "desierto", "playa"};

    public Mapa(int filas, int columnas) {
        this.tablero = new Ejercito[filas][columnas];
        this.tipoTerritorio = TERRITORIOS[new Random().nextInt(TERRITORIOS.length)]; // Tipo de territorio aleatorio
    }

    public void posicionarEjercito(Ejercito ejercito) {
        Random random = new Random();
        int fila, columna;
        do {
            fila = random.nextInt(tablero.length);
            columna = random.nextInt(tablero[0].length);
        } while (tablero[fila][columna] != null); 

        tablero[fila][columna] = ejercito;
        aplicarBonificacion(ejercito);
    }

    private void aplicarBonificacion(Ejercito ejercito) {
        
        String reino = ejercito.getReino();
        if ((tipoTerritorio.equals("bosque") && (reino.equals("Inglaterra") || reino.equals("Sacro Imperio Romano-Germ치nico"))) ||
            (tipoTerritorio.equals("campo abierto") && reino.equals("Francia")) ||
            (tipoTerritorio.equals("monta침a") && reino.equals("Castilla-Arag칩n")) ||
            (tipoTerritorio.equals("desierto") && reino.equals("Moros"))) {
            
           
            for (Soldado soldado : ejercito.getSoldados()) {
                soldado.aumentarVida();
            }
        }
    }

    public Ejercito combate(Ejercito ejercito1, Ejercito ejercito2) {
        int fuerzaEjercito1 = ejercito1.nivelVidaTotal();
        int fuerzaEjercito2 = ejercito2.nivelVidaTotal();
        int danio = 2;

        if (fuerzaEjercito1 > fuerzaEjercito2) {
            ejercito2.reducirVida(danio);
            if (ejercito2.estaDerrotado()) return ejercito1;
        } else if (fuerzaEjercito2 > fuerzaEjercito1) {
            ejercito1.reducirVida(danio);
            if (ejercito1.estaDerrotado()) return ejercito2;
        }
        return null;
    }
    
    public String toString() {
        StringBuilder sb = new StringBuilder("Mapa de tipo de territorio: " + tipoTerritorio + "\n");
        for (int i = 0; i < tablero.length; i++) {
            for (int j = 0; j < tablero[i].length; j++) {
                if (tablero[i][j] == null) {
                    sb.append("[   ] ");
                } else {
                    sb.append("[E] ");
                }
            }
            sb.append("\n");
        }
        return sb.toString();
    }
}
